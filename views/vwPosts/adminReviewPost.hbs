{{#section 'js'}}
<script>
  $('#subcategory')
  .find('optgroup').hide(); // initialize
  /*$('#formPostAdmin'){
    var $curLv1 = $(this).find(class="Category-{{CatIDLv1}}");
    attr('selected', 'selected');  
  } */
  $('#category')
  .change(function() {
    var $cat = $(this).find('option:selected');
    var $subCat = $('#subcategory').find('.' + $cat.attr('class'));
    $('#subcategory').find('optgroup').not("'"+ '.' + $cat.attr('class') + "'").hide(); // hide other optgroup
    $subCat.show();
    $subCat.find('option').first().attr('selected', 'selected');
  }); 
  $('#category').val("{{post.CatIDLv1}}").change();
  $('.Category-{{post.CatIDLv1}} option[value="{{post.CatIDLv2}}"]').attr('selected','selected');
  {{#each post.tag}}
    $("#tagCheckbox{{TagID}}").prop('checked', true);
  {{/each}}

</script>
<script>
  document.querySelector('#btnSubmit').addEventListener('click',function(e){
    var opt = document.querySelector('#postStatus').value;
    if(opt=== "2"){
      var cmts = document.querySelector('#txtComments').value;
     
      if( cmts.length === 0){
        alert('Yêu cầu viết chú thích trước khi từ chối bài viết');
        e.preventDefault();
      }
      
    }
    else if(opt==="1"||opt==="0"){
      var datetime = document.querySelector('#datePost').value;
      if( datetime.length === 0){
        alert('Yêu cầu chọn ngày xuất bản!!');
        e.preventDefault();
      }  
    }
  });
</script>
<script>
$('#tuchoi').hide();
function myFunction(){
  var x = document.getElementById("postStatus").value;
  if(x==1){
    $('#xuatban').show();
    $('#tuchoi').hide();

  }
  else{
     $('#xuatban').hide();
     $('#tuchoi').show();
  }
}



</script>

{{/section}}
<div class="card">
  <h4 class="card-header">
    Duyệt bài viết
  </h4>
  <div class="card-body">
    <form method="POST" action="/admin/reviewPost/{{post.PostID}}">
        <div class="form-group">
          <label for="txtID">ID Bài viết</label>
          <input type="text" readonly class="form-control" id="txtID" name="txtID" value= "{{post.PostID}}"> 
        </div>
        <div class="form-group">
            <label for="txtPostName">Tên bài viết</label>
            <p class="text-primary">{{post.PostName}}</p>
        </div>
        <p>Duyệt bài viết</p> 
        <select class="form-control col-sm-3" id="postStatus" name="postStatus" onchange="myFunction()" required>  
          <option value="1">Xuất bản</option>
          <option value="2">Từ chối</option>
        </select>
        <div id="xuatban">
        <div class="form-group">
        <label for="txtCat">Chuyên mục</label>
        <br>
        <div class="" >
          <select class="form-control col-sm-3" name="CatIDLv1" id="category" required>
              <option value="">Chọn chuyên mục cấp 1</option>
              {{#each lcCategories}}
                 <option class="Category-{{CatIDLv1}}" value="{{CatIDLv1}}">{{CatNameLv1}}</option>
              {{/each}}
          </select>
          <select class="form-control col-sm-3" name="CatIDLv2"  id="subcategory" required>
            {{#each lcCategories}}
              <optgroup class="Category-{{CatIDLv1}}" required>
              <option value="">Chọn chuyên mục cấp 2</option>
              {{#each CatName}}
                <option value="{{CatIDLv2}}">{{CatNameLv2}}</option>
              {{/each}}
            </optgroup>
            {{/each}}
          </select>
        </div> 
      </div>
      <label for="postPremium">Loại bài viết</label><br>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="postPremium" id="exampleRadios1" value="0" checked>
        <label class="form-check-label" for="exampleRadios1">Public</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="postPremium" id="exampleRadios2" value="1">
        <label class="form-check-label" for="exampleRadios2">Premium</label>
      </div>
      <label for="datePost">Ngày xuất bản</label><br>
      <input type="datetime-local" id="datePost" name="datePost">
   
      <div class="form-group">
        <label for="txtTags">Nhãn</label>
        <br>
        {{#each tags}}
          <div class="form-check form-check-inline" >
            <input class="form-check-input" type="checkbox" name="TagID" id="tagCheckbox{{TagID}}" value="{{TagID}}">
            <label class="form-check-label" for="tagCheckbox{{TagID}}">{{TagName}}</label>
          </div>
        {{/each}}
      </div>
      </div>
      <div id="tuchoi">
      <div class="form-group">
        <label for="txtTags">Nhận xét</label>
        <input type="text" class="form-control" id="txtComments" name="txtComments" >
      </div>
      </div>
      <a class="btn btn-primary" href="/admin/posts" role="button">
        <i class="fa fa-backward" aria-hidden="true"></i>
        Quay trở lại
      </a>
      <button type="submit" class="btn btn-success" id="btnSubmit">
        <i class="fa fa-check" aria-hidden="true"></i>
        Xác nhận
      </button>
      
    </form>
  </div>
</div>