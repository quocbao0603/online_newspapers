{{#section 'css'}}
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.css">
{{/section}}
{{#section 'js'}}
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.js"></script>

<script>
  $(document).ready(function () {
    $("#myInput").on("keyup", function () {
      var value = $(this).val().toLowerCase();
      $("#myTable tr").filter(function () {
        $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
      });
    });

  });
  $(document).ready(function () {
    $('#myposts').DataTable({
      paging: false,
      searching: false,
      bInfo: false,
    });
  });

</script>
{{/section}}
<div class="card">
  <h4 class="card-header d-flex justify-content-between">
    {{this.title}}
    <a class="btn btn-outline-success" href="/writer/posts/add" role="button">
      <i class="fa fa-plus" aria-hidden="true"></i>
      Bài viết mới
    </a>
  </h4>
  <div class="card-body">
    {{#if this.empty}}
    <h5 class="card-title">Không có dữ liệu!</h5>
    <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
    {{else}}
    <input class="form-control" id="myInput" type="text" placeholder="Tìm kiếm..">

    <table id="myposts" class="table table-bordered">
      <thead>
        <tr>
          <th scope="col">STT</th>
          <th scope="col">Tên bài viết</th>
          <th scope="col">Chuyên mục</th>
          <th scope="col">Nhãn</th>
          <th scope="col">Trạng thái</th>
          <th scope="col">Cập nhật</i> </th>
        </tr>
      </thead>
      <tbody id="myTable">
        {{#each this.posts}}
        <tr>
          <td scope="row">{{format_index @index}}</td>
          <td><a class="text-primary" href="/posts/details/{{PostID}}">{{PostName}}</a></td>
          <td><a href="/posts/byCat/{{CatIDLv1}}/{{CatIDLv2}}" class="badge badge-secondary">{{CatNameLv1}} |
              {{CatNameLv2}}</a></td>
          <td>{{#each tag}}
            <a href="/posts/tags/{{TagID}}" class="badge badge-primary">{{TagName}}</a>
            {{/each}}
          </td>
          <td>
            {{#ifEquals Status "0"}}
            Đã được duyệt & chờ xuất bản
            {{/ifEquals}}
            {{#ifEquals Status "1"}}
            Đã xuất bản
            {{/ifEquals}}
            {{#ifEquals Status "2"}}
            <div class="text-danger">Bị từ chối</div>
            {{/ifEquals}}
            {{#ifEquals Status "3"}}
            <div class="text-primary">Chưa được duyệt</div>
            {{/ifEquals}}
          </td>
          <td>
            {{#ifEquals Status "2"}}
            <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#myModal">
              <i class="fa fa-eye" aria-hidden="true"></i>
            </button>

            <div class="modal" id="myModal">
              <div class="modal-dialog">
                <div class="modal-content">

                  <!-- Modal Header -->
                  <div class="modal-header">
                    <h4 class="modal-title">Lý do bị từ chối</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                  </div>

                  <!-- Modal body -->
                  <div class="modal-body">
                    {{Notice}}
                  </div>

                  <!-- Modal footer -->
                  <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">Đóng</button>
                    <a href="/writer/posts/edit?id={{PostID}}">
                      <button type="button" class="btn btn-danger">
                        <i class="fa fa-pencil" aria-hidden="true"></i>
                      </button>
                    </a>
                  </div>

                </div>
              </div>
            </div>

            {{/ifEquals}}
            {{#ifEquals Status "3"}}
            <a href="/writer/posts/edit?id={{PostID}}">
              <button type="button" class="btn btn-danger">
                <i class="fa fa-pencil" aria-hidden="true"></i>
              </button>
            </a>
            {{/ifEquals}}
          </td>
        </tr>

        {{/each}}
      </tbody>
    </table>
    <br>
    <nav aria-label="...">
      <ul class="pagination">
        <li class="page-item disabled">
          <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Previous</a>
        </li>
        {{#each this.page_numbers}}
        {{#if isCurrent}}
        <li class="page-item active">
          <a class="page-link" href="javascript:;">{{value}}</a>
        </li>
        {{else}}
        <li class="page-item">
          <a class="page-link" href="?page={{value}}">{{value}}</a>
        </li>
        {{/if}}
        {{/each}}
        <li class="page-item">
          <a class="page-link" href="?page=">Next</a>
        </li>
      </ul>
    </nav>
    {{/if}}
  </div>
</div>